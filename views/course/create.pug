extends ../layout

block variables
  - var __title__ = 'Create new course'
  - var __page__ = 'courses:create'
  - var __pages__ = __page__.split(':')
  - var __breadcrumb__ = [{title:'Home', link:'/'}, {title:'Course list', link:'/courses'}]
  - var course = course || {}

block content
  .wrapper.wrapper-content.animated.fadeInRight
    .row
      .col-lg-6
        .ibox
          .ibox-title
            h5 Basic information
          .ibox-content
            form(method='POST', action='/courses/create')
              input.form-control(type='hidden', name='_csrf', value=_csrf)
              .form-group.row
                label.col-sm-2.col-form-label Course title
                .col-sm-10
                  input.form-control(type='text', name='title', placeholder='Course title', value=course.title)
              .form-group.row
                label.col-sm-2.col-form-label Description
                .col-sm-10
                  input.form-control(type='text', name='desc', placeholder='Description', value=course.title)
              .hr-line-dashed
              .form-group.row
                .col-sm-12
                  a.btn.btn-white(onlick='window.history.back(); return false;') Cancel
                  button.btn.btn-primary(type='submit') Create
          
        //- .col-lg-8
        //-   .ibox
        //-     .ibox-title
        //-       h5 Modules
        //-     .ibox-content
        //-       p Add new module
        //-       .input-group
        //-         input.form-control(id='new-module-name', type='text', placeholder='New module name')
        //-         span.input-group-append
        //-           button.btn.btn-primary(id='add-new-module', type='button') Add
        //-       .hr-line-dashed
        //-       #modules
        //-         .module
        //-           h3.m-t-none.m-b Module #1
        //-           .form-group.row
        //-             label.col-sm-2.col-form-label Module title
        //-             .col-sm-10
        //-               input.form-control(type='text', name='modules[0].title', placeholder='Module title')
        //-           .form-group.row
        //-             label.col-sm-2.col-form-label Module description
        //-             .col-sm-10
        //-               input.form-control(type='text', name='modules[0].desc', placeholder='Module description')
        //-           .hr-line-dashed
                    
        
        
        //- .col-lg-12
        //-   .ibox
        //-     .ibox-title
        //-       h5
        //-         | Information
        //-         //- small 
        //-       //- .ibox-tools
        //-       //-   a.collapse-link
        //-       //-     i.fa.fa-chevron-up
        //-       //-   a.dropdown-toggle(data-toggle='dropdown', href='#')
        //-       //-     i.fa.fa-wrench
        //-       //-   ul.dropdown-menu.dropdown-user
        //-       //-     li
        //-       //-       a.dropdown-item(href='#') Config option 1
        //-       //-     li
        //-       //-       a.dropdown-item(href='#') Config option 2
        //-       //-   a.close-link
        //-       //-     i.fa.fa-times
        //-     .ibox-content
        //- 
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Title
        //-           .col-sm-10
        //-             input.form-control(type='text', name='title', placeholder=course.title)
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Desc
        //-           .col-sm-10
        //-             input.form-control(type='text', name='desc', placeholder=course.title)
        //-             //- span.form-text.m-b-none A block of help text that breaks onto a new line and may extend beyond one line.
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Password
        //-           .col-sm-10
        //-             input.form-control(type='password', name='password')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Placeholder
        //-           .col-sm-10
        //-             input.form-control(type='text', placeholder='placeholder')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-lg-2.col-form-label Disabled
        //-           .col-lg-10
        //-             input.form-control(type='text', disabled='', placeholder='Disabled input here...')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-lg-2.col-form-label Static control
        //-           .col-lg-10
        //-             p.form-control-static email@example.com
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label
        //-             | Checkboxes and radios 
        //-             br
        //-             small.text-navy Normal Bootstrap elements
        //-           .col-sm-10
        //-             div
        //-               label
        //-                 input(type='checkbox', value='')
        //-                 |  Option one is this and that—be sure to include why it's great
        //-             div
        //-               label
        //-                 input#optionsRadios1(type='radio', checked='', value='option1', name='optionsRadios')
        //-                 |  Option one is this and that—be sure to
        //-                 |                           include why it's great
        //-             div
        //-               label
        //-                 input#optionsRadios2(type='radio', value='option2', name='optionsRadios')
        //-                 |  Option two can be something else and selecting it will
        //-                 |                           deselect option one
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Inline checkboxes
        //-           .col-sm-10
        //-             label
        //-               input#inlineCheckbox1(type='checkbox', value='option1')
        //-               |  a
        //-             label.checkbox-inline
        //-               input#inlineCheckbox2(type='checkbox', value='option2')
        //-               |  b
        //-             label
        //-               input#inlineCheckbox3(type='checkbox', value='option3')
        //-               |  c
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label
        //-             | Checkboxes & radios 
        //-             br
        //-             small.text-navy Custom elements
        //-           .col-sm-10
        //-             .i-checks
        //-               label
        //-                 input(type='checkbox', value='')
        //-                 i
        //-                 |  Option one
        //-             .i-checks
        //-               label
        //-                 input(type='checkbox', value='', checked='')
        //-                 i
        //-                 |  Option two checked
        //-             .i-checks
        //-               label
        //-                 input(type='checkbox', value='', disabled='', checked='')
        //-                 i
        //-                 |  Option three checked and disabled
        //-             .i-checks
        //-               label
        //-                 input(type='checkbox', value='', disabled='')
        //-                 i
        //-                 |  Option four disabled
        //-             .i-checks
        //-               label
        //-                 input(type='radio', value='option1', name='a')
        //-                 i
        //-                 |  Option one
        //-             .i-checks
        //-               label
        //-                 input(type='radio', checked='', value='option2', name='a')
        //-                 i
        //-                 |  Option two checked
        //-             .i-checks
        //-               label
        //-                 input(type='radio', disabled='', checked='', value='option2')
        //-                 i
        //-                 |  Option three checked and disabled
        //-             .i-checks
        //-               label
        //-                 input(type='radio', disabled='', name='a')
        //-                 i
        //-                 |  Option four disabled
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Inline checkboxes
        //-           .col-sm-10
        //-             label.checkbox-inline.i-checks
        //-               input(type='checkbox', value='option1')
        //-               | a
        //-             label.i-checks
        //-               input(type='checkbox', value='option2')
        //-               |  b
        //-             label.i-checks
        //-               input(type='checkbox', value='option3')
        //-               |  c
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Select
        //-           .col-sm-10
        //-             select.form-control.m-b(name='account')
        //-               option option 1
        //-               option option 2
        //-               option option 3
        //-               option option 4
        //-             .col-lg-4.m-l-n
        //-               select.form-control(multiple='')
        //-                 option option 1
        //-                 option option 2
        //-                 option option 3
        //-                 option option 4
        //-         .hr-line-dashed
        //-         .form-group.row.has-success
        //-           label.col-sm-2.col-form-label Input with success
        //-           .col-sm-10
        //-             input.form-control(type='text')
        //-         .hr-line-dashed
        //-         .form-group.row.has-warning
        //-           label.col-sm-2.col-form-label Input with warning
        //-           .col-sm-10
        //-             input.form-control(type='text')
        //-         .hr-line-dashed
        //-         .form-group.row.has-error
        //-           label.col-sm-2.col-form-label Input with error
        //-           .col-sm-10
        //-             input.form-control(type='text')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Control sizing
        //-           .col-sm-10
        //-             input.form-control.form-control-lg.m-b(type='text', placeholder='.form-control-lg')
        //-             input.form-control.m-b(type='text', placeholder='Default input')
        //-             input.form-control.form-control-sm(type='text', placeholder='.form-control-sm')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Column sizing
        //-           .col-sm-10
        //-             .row
        //-               .col-md-2
        //-                 input.form-control(type='text', placeholder='.col-md-2')
        //-               .col-md-3
        //-                 input.form-control(type='text', placeholder='.col-md-3')
        //-               .col-md-4
        //-                 input.form-control(type='text', placeholder='.col-md-4')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Input groups
        //-           .col-sm-10
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 span.input-group-addon @
        //-               input.form-control(type='text', placeholder='Username')
        //-             .input-group.m-b
        //-               input.form-control(type='text')
        //-               .input-group-append
        //-                 span.input-group-addon .00
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 span.input-group-addon $
        //-               input.form-control(type='text')
        //-               .input-group-append
        //-                 span.input-group-addon .00
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 span.input-group-addon
        //-                   input(type='checkbox')
        //-               input.form-control(type='text')
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 span.input-group-addon
        //-                   input(type='radio')
        //-               input.form-control(type='text')
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Button addons
        //-           .col-sm-10
        //-             .input-group.m-b
        //-               span.input-group-prepend
        //-                 button.btn.btn-primary(type='button') Go!
        //-               input.form-control(type='text')
        //-             .input-group
        //-               input.form-control(type='text')
        //-               span.input-group-append
        //-                 button.btn.btn-primary(type='button')
        //-                   | Go!
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label With dropdowns
        //-           .col-sm-10
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 button.btn.btn-white.dropdown-toggle(data-toggle='dropdown', type='button') Action 
        //-                 ul.dropdown-menu
        //-                   li
        //-                     a(href='#') Action
        //-                   li
        //-                     a(href='#') Another action
        //-                   li
        //-                     a(href='#') Something else here
        //-                   li.dropdown-divider
        //-                   li
        //-                     a(href='#') Separated link
        //-               input.form-control(type='text')
        //-             .input-group
        //-               input.form-control(type='text')
        //-               .input-group-append
        //-                 button.btn.btn-white.dropdown-toggle(data-toggle='dropdown', type='button') Action 
        //-                 ul.dropdown-menu.float-right
        //-                   li
        //-                     a(href='#') Action
        //-                   li
        //-                     a(href='#') Another action
        //-                   li
        //-                     a(href='#') Something else here
        //-                   li.dropdown-divider
        //-                   li
        //-                     a(href='#') Separated link
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           label.col-sm-2.col-form-label Segmented
        //-           .col-sm-10
        //-             .input-group.m-b
        //-               .input-group-prepend
        //-                 button.btn.btn-white(tabindex='-1', type='button') Action
        //-                 button.btn.btn-white.dropdown-toggle(data-toggle='dropdown', type='button')
        //-                 ul.dropdown-menu
        //-                   li
        //-                     a(href='#') Action
        //-                   li
        //-                     a(href='#') Another action
        //-                   li
        //-                     a(href='#') Something else here
        //-                   li.dropdown-divider
        //-                   li
        //-                     a(href='#') Separated link
        //-               input.form-control(type='text')
        //-             .input-group
        //-               input.form-control(type='text')
        //-               .input-group-append
        //-                 button.btn.btn-white(tabindex='-1', type='button') Action
        //-                 button.btn.btn-white.dropdown-toggle(data-toggle='dropdown', type='button')
        //-                 ul.dropdown-menu.float-right
        //-                   li
        //-                     a(href='#') Action
        //-                   li
        //-                     a(href='#') Another action
        //-                   li
        //-                     a(href='#') Something else here
        //-                   li.dropdown-divider
        //-                   li
        //-                     a(href='#') Separated link
        //-         .hr-line-dashed
        //-         .form-group.row
        //-           .col-sm-4.col-sm-offset-2
        //-             button.btn.btn-white.btn-sm(type='submit') Cancel
        //-             button.btn.btn-primary.btn-sm(type='submit') Save changes


block scripts
  script.
    $(document).ready(function() {
      $("#wizard").steps();
      $("#form").steps({
        bodyTag: "fieldset",
        onStepChanging: function(event, currentIndex, newIndex) {
          // Always allow going backward even if the current step contains invalid fields!
          if (currentIndex > newIndex) {
            return true;
          }

          // Forbid suppressing "Warning" step if the user is to young
          if (newIndex === 3 && Number($("#age").val()) < 18) {
            return false;
          }

          var form = $(this);

          // Clean up if user went backward before
          if (currentIndex < newIndex) {
            // To remove error styles
            $(".body:eq(" + newIndex + ") label.error", form).remove();
            $(".body:eq(" + newIndex + ") .error", form).removeClass("error");
          }

          // Disable validation on fields that are disabled or hidden.
          form.validate().settings.ignore = ":disabled,:hidden";

          // Start validation; Prevent going forward if false
          return form.valid();
        },
        onStepChanged: function(event, currentIndex, priorIndex) {
          // Suppress (skip) "Warning" step if the user is old enough.
          if (currentIndex === 2 && Number($("#age").val()) >= 18) {
            $(this).steps("next");
          }

          // Suppress (skip) "Warning" step if the user is old enough and wants to the previous step.
          if (currentIndex === 2 && priorIndex === 3) {
            $(this).steps("previous");
          }
        },
        onFinishing: function(event, currentIndex) {
          var form = $(this);

          // Disable validation on fields that are disabled.
          // At this point it's recommended to do an overall check (mean ignoring only disabled fields)
          form.validate().settings.ignore = ":disabled";

          // Start validation; Prevent form submission if false
          return form.valid();
        },
        onFinished: function(event, currentIndex) {
          var form = $(this);

          // Submit form input
          form.submit();
        }
      }).validate({
        errorPlacement: function(error, element) {
          element.before(error);
        },
        rules: {
          confirm: {
            /* equalTo: "#password" */
          }
        }
      });
    });

  //- /* script. */
    $(document).ready(function() {
      var modules = [];


      function renderModules(mods) {
        var block = $('#modules');
        
        block.empty();
        
        mods.filter(function(_){return _;}).forEach(function(mod, ind) {
            block.append($(`<div class="module">
              <h3 class="m-t-none m-b">
                Module #${ind+1}
                <button type="button" class="btn btn-primary btn-xs float-right">Delete</button>
              </h3>
              <input type='hidden' name="modules[${ind}]._id" value="mod._id">
              <div class="form-group row">
                <label class="col-sm-2 col-form-label">Module title</label>
                <div class="col-sm-10"><input class="form-control" type="text" name="modules[${ind}].title" placeholder="Module title" value="${mod.title}" required></div>
              </div>
              <div class="form-group row">
                <label class="col-sm-2 col-form-label">Module description</label>
                <div class="col-sm-10"><input class="form-control" type="text" name="modules[${ind}].desc" placeholder="Module description" value="${mod.desc}" required></div>
              </div>
              <div class="hr-line-dashed"></div>
            </div>`));
        });
      }

      $('#add-new-module').on('click', function() {
        modules.push({title:$('#new-module-name').val(),desc:''});
        $('#new-module-name').val();
        renderModules(modules);
      });


    });
